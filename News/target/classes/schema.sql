DROP TABLE IF EXISTS Category;
CREATE TABLE Category(
	id int NOT NULL,
	name varchar(50) NOT NULL,
 CONSTRAINT PK_Category PRIMARY KEY  
(
	id ASC
)
);



DROP TABLE IF EXISTS News;
CREATE TABLE News(
	id int NOT NULL generated by default as identity,
	news varchar(255) NOT NULL,
	category int NOT NULL,
	source varchar(50) NULL,
	creationDate datetime NOT NULL,
 CONSTRAINT PK_News PRIMARY KEY 
(
	id ASC
));

DROP TABLE IF EXISTS Users;
CREATE TABLE Users(
	id int NOT NULL,
	name varchar(50) NOT NULL,
	status int NOT NULL default 0,
 CONSTRAINT PK_Users PRIMARY KEY  
(
	id ASC
)
);

DROP TABLE IF EXISTS UserStatus;
CREATE TABLE UserStatus(
	id int NOT NULL,
	name varchar(50) NOT NULL,
 CONSTRAINT PK_UserStatus PRIMARY KEY  
(
	id ASC
)
);


DROP TABLE IF EXISTS UserCategories;
CREATE TABLE UserCategories(
	userId int NOT NULL,
	categoryId int NOT NULL,
 CONSTRAINT PK_UserCategories PRIMARY KEY  
(
	userId, categoryId ASC
)
);



DROP TABLE IF EXISTS UserNews;
CREATE TABLE UserNews(
	userId int NOT NULL,
	newsId int NOT NULL,
    status int NOT NULL DEFAULT 1,
 CONSTRAINT PK_UserNews PRIMARY KEY  
(
	userId, newsId ASC
)
);

DROP TABLE IF EXISTS UserNewsDeliveryStatus;
CREATE TABLE UserNewsDeliveryStatus(
	id int NOT NULL,
	name varchar(50) NOT NULL,
 CONSTRAINT PK_UserNewsDeliveryStatus PRIMARY KEY  
(
	id ASC
)
);


--UserCategories
--UserCategories FK with Category
ALTER TABLE UserCategories  ADD  CONSTRAINT FK_UserCategories_Category FOREIGN KEY(CategoryId)
REFERENCES Category (id);
--UserCategories FK with Users
ALTER TABLE UserCategories  ADD  CONSTRAINT FK_UserCategories_Users FOREIGN KEY(userId)
REFERENCES Users (id);

--User News
--user news FK with users
ALTER TABLE UserNews  ADD  CONSTRAINT FK_UserNews_Users FOREIGN KEY(userId)
REFERENCES Users (id);
--user news FK with News
ALTER TABLE UserNews  ADD  CONSTRAINT FK_UserNews_News FOREIGN KEY(newsId)
REFERENCES news (id);
--user news FK with User#NewsDeliveryStatus
ALTER TABLE UserNews  ADD  CONSTRAINT FK_UserNews_USERNEWSDELIVERYSTATUS  FOREIGN KEY(STATUS)
REFERENCES USERNEWSDELIVERYSTATUS (id);

--Users FK with UsersStatus
ALTER TABLE Users ADD  CONSTRAINT FK_Users_UserStatus FOREIGN KEY(Status)
REFERENCES UserStatus(id);

